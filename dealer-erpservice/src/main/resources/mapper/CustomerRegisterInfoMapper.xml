<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.utonw.utonerp.mapper.CustomerRegisterInfoMapper">
    <resultMap id="BaseResultMap" type="com.utonw.dealer.api.entity.erp.CustomerRegisterInfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="uuid" jdbcType="VARCHAR" property="uuid"/>
        <result column="id" jdbcType="INTEGER" property="id"/>
        <result column="customer_name" jdbcType="VARCHAR" property="customerName"/>
        <result column="id_card" jdbcType="VARCHAR" property="idCard"/>
        <result column="mobile" jdbcType="VARCHAR" property="mobile"/>
        <result column="age" jdbcType="INTEGER" property="age"/>
        <result column="sex" jdbcType="VARCHAR" property="sex"/>
        <result column="education" jdbcType="VARCHAR" property="education"/>
        <result column="marital_status" jdbcType="VARCHAR" property="maritalStatus"/>
        <result column="register_status" jdbcType="VARCHAR" property="registerStatus"/>
        <result column="house" jdbcType="VARCHAR" property="house"/>
        <result column="rental" jdbcType="DECIMAL" property="rental"/>
        <result column="live_number" jdbcType="INTEGER" property="liveNumber"/>
        <result column="koseki_address" jdbcType="VARCHAR" property="kosekiAddress"/>
        <result column="live_address" jdbcType="VARCHAR" property="liveAddress"/>
        <result column="create_cm_id" jdbcType="VARCHAR" property="createCmId"/>
        <result column="responsible_cm_id" jdbcType="VARCHAR" property="responsibleCmId"/>
        <result column="dept_id" jdbcType="INTEGER" property="deptId"/>
        <result column="company_id" jdbcType="INTEGER" property="companyId"/>
        <result column="created_at" jdbcType="TIMESTAMP" property="createdAt"/>
        <result column="updated_at" jdbcType="TIMESTAMP" property="updatedAt"/>
        <result column="credit_card_bankname" jdbcType="VARCHAR" property="creditCardBankName"/>
        <result column="credit_card" jdbcType="VARCHAR" property="creditCard"/>
        <result column="credit_card_num" jdbcType="INTEGER" property="creditCardNum"/>
        <result column="credit_card_quota" jdbcType="VARCHAR" property="creditCardQuota"/>
        <result column="openIdrate" jdbcType="DOUBLE" property="openIdrate"/>
		<result column="open_id" jdbcType="VARCHAR" property="openId"/>
		<result column="is_important" jdbcType="INTEGER" property="isImportant"/>
		<result column="is_blacklist" jdbcType="INTEGER" property="isBlacklist"/>
        <result column="marry_period" jdbcType="TINYINT" property="marry_period"/>
        <result column="number_of_children" jdbcType="TINYINT" property="number_of_children"/>
        <result column="status_of_children" jdbcType="VARCHAR" property="status_of_children"/>
        <result column="home_tel" jdbcType="VARCHAR" property="home_tel"/>
        <result column="residence_period" jdbcType="TINYINT" property="residence_period"/>
        <result column="residence_period_current" jdbcType="TINYINT" property="residence_period_current"/>
        <result column="cohabitant" jdbcType="TINYINT" property="cohabitant"/>
        <result column="building_type" jdbcType="TINYINT" property="building_type"/>
        <result column="room_charge" jdbcType="DECIMAL" property="room_charge"/>
    </resultMap>
    <resultMap extends="BaseResultMap" id="ResultMapWithBLOBs"
               type="com.utonw.dealer.api.entity.erp.CustomerRegisterInfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <result column="remark" jdbcType="LONGVARCHAR" property="remark"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        uuid, id, customer_name, id_card, mobile, age, sex, education, marital_status,
        register_status,
        house, rental, live_number, koseki_address, live_address, create_cm_id, responsible_cm_id,
        dept_id, company_id, created_at, updated_at,credit_card_bankname,credit_card,openIdrate
    </sql>
    <sql id="Blob_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        remark
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.String"
            resultMap="getCustomerListPageResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        cri.uuid, cri.id, cri.customer_name, cri.id_card, cri.mobile, cri.age, cri.sex,
        cri.education, cri.marital_status,
        cri.register_status,
        cri.house, cri.rental, cri.live_number, cri.koseki_address, cri.live_address,
        cri.create_cm_id, cri.responsible_cm_id,
        cri.dept_id, cri.company_id, cri.created_at, cri.updated_at,
        cri.credit_card_bankname,cri.credit_card,
        cri.credit_card_num,cri.credit_card_quota,
        cri.remark,com.name company_name,
        cri.is_important,cri.is_blacklist,cri.marry_period,cri.number_of_children,cri.status_of_children,
        cri.home_tel,cri.residence_period,cri.residence_period_current,
        cri.cohabitant,cri.building_type,cri.room_charge,
        de.name dept_name,
        u.realname
        from customer_register_info cri
        LEFT JOIN company com ON cri.company_id = com.id
        LEFT JOIN dept de on cri.dept_id = de.id
        LEFT JOIN user u ON cri.responsible_cm_id = u.uuid
        where cri.uuid = #{uuid,jdbcType=VARCHAR}
    </select>
     <select id="selectByPrimaryKey1" parameterType="java.lang.String"
            resultMap="getCustomerListPageResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        cri.uuid, cri.id, cri.customer_name, cri.id_card, cri.mobile, cri.age, cri.sex,
        cri.education, cri.marital_status,
        cri.register_status,
        cri.house, cri.rental, cri.live_number, cri.koseki_address, cri.live_address,
        cri.create_cm_id, cri.responsible_cm_id,
        cri.dept_id, cri.company_id, cri.created_at, cri.updated_at,
        cri.credit_card_bankname,cri.credit_card,
        cri.credit_card_num,cri.credit_card_quota,cri.marry_period,cri.number_of_children,cri.status_of_children,
         cri.home_tel,cri.residence_period,cri.residence_period_current,
         cri.cohabitant,cri.building_type,cri.room_charge,
        cri.remark,com.name company_name,
        de.name dept_name,
        u.realname
        from customer_register_info cri
        LEFT JOIN loan_info lo ON lo.customer_id=cri.uuid 
        LEFT JOIN company com ON cri.company_id = com.id
        LEFT JOIN dept de on cri.dept_id = de.id
        LEFT JOIN user u ON cri.responsible_cm_id = u.uuid

        where lo.customer_id= #{uuid,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from customer_register_info
        where uuid = #{uuid,jdbcType=VARCHAR}
    </delete>
    <insert id="insert" parameterType="com.utonw.dealer.api.entity.erp.CustomerRegisterInfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into customer_register_info (uuid, id, customer_name,
        id_card, mobile, age,
        sex, education, marital_status,
        register_status, house, rental,
        live_number, koseki_address, live_address,
        create_cm_id, responsible_cm_id, dept_id,
        company_id, created_at, updated_at,credit_card_bankname,credit_card,
        remark,openIdrate,marry_period,number_of_children,status_of_children,home_tel,residence_period,
        residence_period_current,cohabitant,building_type,room_charge)
        values (#{uuid,jdbcType=VARCHAR}, #{id,jdbcType=INTEGER}, #{customerName,jdbcType=VARCHAR},
        #{idCard,jdbcType=VARCHAR}, #{mobile,jdbcType=VARCHAR}, #{age,jdbcType=INTEGER},
        #{sex,jdbcType=VARCHAR}, #{education,jdbcType=VARCHAR}, #{maritalStatus,jdbcType=VARCHAR},
        #{registerStatus,jdbcType=VARCHAR}, #{house,jdbcType=VARCHAR}, #{rental,jdbcType=DECIMAL},
        #{liveNumber,jdbcType=INTEGER}, #{kosekiAddress,jdbcType=VARCHAR},
        #{liveAddress,jdbcType=VARCHAR},
        #{createCmId,jdbcType=VARCHAR}, #{responsibleCmId,jdbcType=VARCHAR},
        #{deptId,jdbcType=INTEGER},
        #{companyId,jdbcType=INTEGER}, #{createdAt,jdbcType=TIMESTAMP},
        #{updatedAt,jdbcType=TIMESTAMP}, #{creditCardBankName,jdbcType=VARCHAR},
        #{creditCard,jdbcType=VARCHAR},
        #{remark,jdbcType=LONGVARCHAR},
        #{openIdrate,jdbcType=DOUBLE},
        #{marry_period,jdbcType=TINYINT},
        #{number_of_children,jdbcType=TINYINT},
        #{status_of_children,jdbcType=VARCHAR},
        #{status_of_children,jdbcType=TINYINT},
        #{home_tel,jdbcType=VARCHAR},
        #{residence_period,jdbcType=TINYINT},
        #{residence_period_current,jdbcType=TINYINT},
        #{cohabitant,jdbcType=TINYINT},
        #{building_type,jdbcType=TINYINT},
        #{room_charge,jdbcType=DECIMAL}
        )
    </insert>
    <insert id="insertSelective" parameterType="com.utonw.dealer.api.entity.erp.CustomerRegisterInfo"
            keyProperty="uuid">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into customer_register_info
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="uuid != null">
                uuid,
            </if>
            <if test="id != null">
                id,
            </if>
            <if test="customerName != null">
                customer_name,
            </if>
            <if test="idCard != null">
                id_card,
            </if>
            <if test="mobile != null">
                mobile,
            </if>
            <if test="age != null">
                age,
            </if>
            <if test="sex != null">
                sex,
            </if>
            <if test="education != null">
                education,
            </if>
            <if test="maritalStatus != null">
                marital_status,
            </if>
            <if test="registerStatus != null">
                register_status,
            </if>
            <if test="house != null">
                house,
            </if>
            <if test="rental != null">
                rental,
            </if>
            <if test="liveNumber != null">
                live_number,
            </if>
            <if test="kosekiAddress != null">
                koseki_address,
            </if>
            <if test="liveAddress != null">
                live_address,
            </if>
            <if test="createCmId != null">
                create_cm_id,
            </if>
            <if test="responsibleCmId != null">
                responsible_cm_id,
            </if>
            <if test="deptId != null">
                dept_id,
            </if>
            <if test="companyId != null">
                company_id,
            </if>
            <if test="createdAt != null">
                created_at,
            </if>
            <if test="updatedAt != null">
                updated_at,
            </if>
            <if test="creditCardBankName != null">
                credit_card_bankname,
            </if>
            <if test="creditCard != null">
                credit_card,
            </if>
            <if test="creditCardNum != null">
                credit_card_num,
            </if>
            <if test="creditCardQuota != null">
                credit_card_quota,
            </if>
            <if test="remark != null">
                remark,
            </if>
            <if test="openId != null">
                open_id,
            </if>
            <if test="orderId != null">
            order_id,
            </if>
            <if test="openIdrate != null">
                openIdrate,
            </if>
            <if test="isImportant != null">
            is_important,
            </if>
            <if test="marry_period != null">
                marry_period,
            </if>
            <if test="number_of_children != null">
                number_of_children,
            </if>
            <if test="status_of_children != null">
                status_of_children,
            </if>
            <if test="home_tel != null">
                home_tel,
            </if>
            <if test="residence_period != null">
                residence_period,
            </if>
            <if test="residence_period_current != null">
                residence_period_current,
            </if>
            <if test="cohabitant != null">
                cohabitant,
            </if>
            <if test="building_type != null">
                building_type,
            </if>
            <if test="room_charge != null">
                room_charge,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="uuid != null">
                #{uuid,jdbcType=VARCHAR},
            </if>
            <if test="id != null">
                #{id,jdbcType=INTEGER},
            </if>
            <if test="customerName != null">
                #{customerName,jdbcType=VARCHAR},
            </if>
            <if test="idCard != null">
                #{idCard,jdbcType=VARCHAR},
            </if>
            <if test="mobile != null">
                #{mobile,jdbcType=VARCHAR},
            </if>
            <if test="age != null">
                #{age,jdbcType=INTEGER},
            </if>
            <if test="sex != null">
                #{sex,jdbcType=VARCHAR},
            </if>
            <if test="education != null">
                #{education,jdbcType=VARCHAR},
            </if>
            <if test="maritalStatus != null">
                #{maritalStatus,jdbcType=VARCHAR},
            </if>
            <if test="registerStatus != null">
                #{registerStatus,jdbcType=VARCHAR},
            </if>
            <if test="house != null">
                #{house,jdbcType=VARCHAR},
            </if>
            <if test="rental != null">
                #{rental,jdbcType=DECIMAL},
            </if>
            <if test="liveNumber != null">
                #{liveNumber,jdbcType=INTEGER},
            </if>
            <if test="kosekiAddress != null">
                #{kosekiAddress,jdbcType=VARCHAR},
            </if>
            <if test="liveAddress != null">
                #{liveAddress,jdbcType=VARCHAR},
            </if>
            <if test="createCmId != null">
                #{createCmId,jdbcType=VARCHAR},
            </if>
            <if test="responsibleCmId != null">
                #{responsibleCmId,jdbcType=VARCHAR},
            </if>
            <if test="deptId != null">
                #{deptId,jdbcType=INTEGER},
            </if>
            <if test="companyId != null">
                #{companyId,jdbcType=INTEGER},
            </if>
            <if test="createdAt != null">
                #{createdAt,jdbcType=TIMESTAMP},
            </if>
            <if test="updatedAt != null">
                #{updatedAt,jdbcType=TIMESTAMP},
            </if>
            <if test="creditCardBankName != null">
                #{creditCardBankName,jdbcType=VARCHAR},
            </if>
            <if test="creditCard != null">
                #{creditCard,jdbcType=VARCHAR},
            </if>
            <if test="creditCardNum != null">
                #{creditCardNum,jdbcType=INTEGER},
            </if>
            <if test="creditCardQuota != null">
                #{creditCardQuota,jdbcType=VARCHAR},
            </if>
            <if test="remark != null">
                #{remark,jdbcType=LONGVARCHAR},
            </if>
            <if test="openId != null">
                #{openId},
            </if>
            <if test="orderId != null">
                #{orderId},
            </if>
            <if test="openIdrate != null">
                #{openIdrate},
            </if>
            <if test="isImportant != null">
                #{isImportant},
            </if>
            <if test="marry_period != null">
                #{marry_period,jdbcType=TINYINT},
            </if>
            <if test="number_of_children != null">
                #{number_of_children,jdbcType=TINYINT},
            </if>
            <if test="status_of_children != null">
                #{status_of_children,jdbcType=TINYINT},
            </if>
            <if test="home_tel != null">
                #{home_tel,jdbcType=VARCHAR},
            </if>
            <if test="residence_period != null">
                #{residence_period,jdbcType=TINYINT},
            </if>
            <if test="residence_period_current != null">
                #{residence_period_current,jdbcType=TINYINT},
            </if>
            <if test="cohabitant != null">
                #{cohabitant,jdbcType=TINYINT},
            </if>
            <if test="building_type != null">
                #{building_type,jdbcType=TINYINT},
            </if>
            <if test="room_charge != null">
                #{room_charge,jdbcType=DECIMAL},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective"
            parameterType="com.utonw.dealer.api.entity.erp.CustomerRegisterInfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update customer_register_info
        <set>
            <if test="id != null">
                id = #{id,jdbcType=INTEGER},
            </if>
            <if test="customerName != null">
                customer_name = #{customerName,jdbcType=VARCHAR},
            </if>
            <if test="idCard != null">
                id_card = #{idCard,jdbcType=VARCHAR},
            </if>
            <if test="mobile != null">
                mobile = #{mobile,jdbcType=VARCHAR},
            </if>
            <if test="age != null">
                age = #{age,jdbcType=INTEGER},
            </if>
            <if test="sex != null">
                sex = #{sex,jdbcType=VARCHAR},
            </if>
            <if test="education != null">
                education = #{education,jdbcType=VARCHAR},
            </if>
            <if test="maritalStatus != null">
                marital_status = #{maritalStatus,jdbcType=VARCHAR},
            </if>
            <if test="registerStatus != null">
                register_status = #{registerStatus,jdbcType=VARCHAR},
            </if>
            <if test="house != null">
                house = #{house,jdbcType=VARCHAR},
            </if>
            <if test="rental != null">
                rental = #{rental,jdbcType=DECIMAL},
            </if>
            <if test="liveNumber != null">
                live_number = #{liveNumber,jdbcType=INTEGER},
            </if>
            <if test="kosekiAddress != null">
                koseki_address = #{kosekiAddress,jdbcType=VARCHAR},
            </if>
            <if test="liveAddress != null">
                live_address = #{liveAddress,jdbcType=VARCHAR},
            </if>
            <if test="createCmId != null">
                create_cm_id = #{createCmId,jdbcType=VARCHAR},
            </if>
            <if test="responsibleCmId != null">
                responsible_cm_id = #{responsibleCmId,jdbcType=VARCHAR},
            </if>
            <if test="deptId != null">
                dept_id = #{deptId,jdbcType=INTEGER},
            </if>
            <if test="companyId != null">
                company_id = #{companyId,jdbcType=INTEGER},
            </if>
            <if test="createdAt != null">
                created_at = #{createdAt,jdbcType=TIMESTAMP},
            </if>
            <if test="updatedAt != null">
                updated_at = #{updatedAt,jdbcType=TIMESTAMP},
            </if>
            <if test="creditCardBankName != null">
                credit_card_bankname = #{creditCardBankName,jdbcType=VARCHAR},
            </if>
            <if test="creditCard != null">
                credit_card = #{creditCard,jdbcType=VARCHAR},
            </if>
            <if test="creditCardNum != null">
                credit_card_num = #{creditCardNum,jdbcType=INTEGER},
            </if>
            <if test="creditCardQuota != null">
                credit_card_quota = #{creditCardQuota,jdbcType=VARCHAR},
            </if>
            <if test="remark != null">
                remark = #{remark,jdbcType=LONGVARCHAR},
            </if>
            <if test="openId != null">
                open_id = #{openId},
            </if>
            <if test="orderId != null">
                order_id = #{orderId},
            </if>
            <if test="openIdrate != null">
                openIdrate = #{openIdrate},
            </if>
            <if test="isImportant != null ">
                is_important = #{isImportant,jdbcType=INTEGER},
            </if>
            <if test="isBlacklist != null ">
                is_blacklist = #{isBlacklist,jdbcType=INTEGER},
            </if>
            <if test="marry_period != null">
                marry_period = #{marry_period,jdbcType=TINYINT},
            </if>
            <if test="number_of_children != null">
                number_of_children = #{number_of_children,jdbcType=TINYINT},
            </if>
            <if test="status_of_children != null">
                status_of_children = #{status_of_children,jdbcType=TINYINT},
            </if>
            <if test="home_tel != null">
                home_tel = #{home_tel,jdbcType=VARCHAR},
            </if>
            <if test="residence_period != null">
                residence_period = #{residence_period,jdbcType=TINYINT},
            </if>
            <if test="residence_period_current != null">
                residence_period_current = #{residence_period_current,jdbcType=TINYINT},
            </if>
            <if test="cohabitant != null">
                cohabitant = #{cohabitant,jdbcType=TINYINT},
            </if>
            <if test="building_type != null">
                building_type = #{building_type,jdbcType=TINYINT},
            </if>
            <if test="room_charge != null">
                room_charge = #{room_charge,jdbcType=DECIMAL},
            </if>
        </set>
        where uuid = #{uuid,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKeyWithBLOBs"
            parameterType="com.utonw.dealer.api.entity.erp.CustomerRegisterInfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update customer_register_info
        set id = #{id,jdbcType=INTEGER},
        customer_name = #{customerName,jdbcType=VARCHAR},
        id_card = #{idCard,jdbcType=VARCHAR},
        mobile = #{mobile,jdbcType=VARCHAR},
        age = #{age,jdbcType=INTEGER},
        sex = #{sex,jdbcType=VARCHAR},
        education = #{education,jdbcType=VARCHAR},
        marital_status = #{maritalStatus,jdbcType=VARCHAR},
        register_status = #{registerStatus,jdbcType=VARCHAR},
        house = #{house,jdbcType=VARCHAR},
        rental = #{rental,jdbcType=DECIMAL},
        live_number = #{liveNumber,jdbcType=INTEGER},
        koseki_address = #{kosekiAddress,jdbcType=VARCHAR},
        live_address = #{liveAddress,jdbcType=VARCHAR},
        create_cm_id = #{createCmId,jdbcType=VARCHAR},
        responsible_cm_id = #{responsibleCmId,jdbcType=VARCHAR},
        dept_id = #{deptId,jdbcType=INTEGER},
        company_id = #{companyId,jdbcType=INTEGER},
        created_at = #{createdAt,jdbcType=TIMESTAMP},
        updated_at = #{updatedAt,jdbcType=TIMESTAMP},
        credit_card_bankname = #{creditCardBankName,jdbcType=VARCHAR},
        credit_card = #{creditCard,jdbcType=VARCHAR},
        remark = #{remark,jdbcType=LONGVARCHAR},
        marry_period = #{marry_period,jdbcType=TINYINT},
        number_of_children = #{number_of_children,jdbcType=TINYINT},
        status_of_children = #{status_of_children,jdbcType=TINYINT},
        home_tel = #{home_tel,jdbcType=VARCHAR},
        residence_period = #{residence_period,jdbcType=TINYINT},
        residence_period_current = #{residence_period_current,jdbcType=TINYINT},
        cohabitant = #{cohabitant,jdbcType=TINYINT},
        building_type = #{building_type,jdbcType=TINYINT},
        room_charge = #{room_charge,jdbcType=DECIMAL},
        business = #{business,jdbcType=DECIMAL}
        where uuid = #{uuid,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.utonw.dealer.api.entity.erp.CustomerRegisterInfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update customer_register_info
        set id = #{id,jdbcType=INTEGER},
        customer_name = #{customerName,jdbcType=VARCHAR},
        id_card = #{idCard,jdbcType=VARCHAR},
        mobile = #{mobile,jdbcType=VARCHAR},
        age = #{age,jdbcType=INTEGER},
        sex = #{sex,jdbcType=VARCHAR},
        education = #{education,jdbcType=VARCHAR},
        marital_status = #{maritalStatus,jdbcType=VARCHAR},
        register_status = #{registerStatus,jdbcType=VARCHAR},
        house = #{house,jdbcType=VARCHAR},
        rental = #{rental,jdbcType=DECIMAL},
        live_number = #{liveNumber,jdbcType=INTEGER},
        koseki_address = #{kosekiAddress,jdbcType=VARCHAR},
        live_address = #{liveAddress,jdbcType=VARCHAR},
        create_cm_id = #{createCmId,jdbcType=VARCHAR},
        responsible_cm_id = #{responsibleCmId,jdbcType=VARCHAR},
        dept_id = #{deptId,jdbcType=INTEGER},
        company_id = #{companyId,jdbcType=INTEGER},
        created_at = #{createdAt,jdbcType=TIMESTAMP},
        updated_at = #{updatedAt,jdbcType=TIMESTAMP},
        credit_card_bankname = #{creditCardBankName,jdbcType=VARCHAR},
        credit_card = #{creditCard,jdbcType=VARCHAR},
        marry_period = #{marry_period,jdbcType=TINYINT},
        number_of_children = #{number_of_children,jdbcType=TINYINT},
        status_of_children = #{status_of_children,jdbcType=TINYINT},
        home_tel = #{home_tel,jdbcType=VARCHAR},
        residence_period = #{residence_period,jdbcType=TINYINT},
        residence_period_current = #{residence_period_current,jdbcType=TINYINT},
        cohabitant = #{cohabitant,jdbcType=TINYINT},
        building_type = #{building_type,jdbcType=TINYINT},
        room_charge = #{room_charge,jdbcType=DECIMAL},
        business = #{business,jdbcType=DECIMAL}
        where uuid = #{uuid,jdbcType=VARCHAR}
    </update>


    <!-- 验证参数唯一性 -->
    <select id="verifyUniquenessFields" resultType="com.utonw.dealer.api.entity.erp.CustomerRegisterInfo"
            parameterType="map">
        SELECT
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from customer_register_info cri WHERE 1=1
        <if test="mobile != null">
            AND cri.mobile = #{mobile}
        </if>
        <if test="idCard != null">
            AND cri.id_card = #{idCard}
        </if>
    </select>

    <!-- 根据公司Id查询出该公司下所有的客户 -->
    <select id="selectCustomerWapper" resultMap="ResultMapWithBLOBs" parameterType="map">
        select
        <include refid="Base_Column_List"/>
        ,
        <include refid="Blob_Column_List"/>
        from customer_register_info
        where 1=1
        <choose>
            <when test="data_access_level != null and data_access_level == 0">
                and 1=0
            </when>
            <when test="data_access_level != null and data_access_level == 1">
                AND responsible_cm_id = #{userId, jdbcType=VARCHAR}
            </when>
            <when test="data_access_level != null and data_access_level == 2">
                AND dept_id = #{myDeptId,jdbcType=INTEGER}
            </when>
            <when test="data_access_level != null and data_access_level == 3">
                AND company_id = #{mycompanyId,jdbcType=INTEGER}
            </when>
        </choose>

    </select>

    <resultMap extends="ResultMapWithBLOBs" id="getCustomerListPageResultMap"
               type="com.utonw.dealer.api.entity.erp.CustomerRegisterInfo">
        <association property="company" column="company_id"
                     javaType="com.utonw.dealer.api.entity.erp.Company">
            <result column="company_name" property="name" jdbcType="VARCHAR"/>
        </association>

        <association property="dept" column="dept_id" javaType="com.utonw.dealer.api.entity.erp.Dept">
            <result column="dept_name" property="name" jdbcType="VARCHAR"/>
        </association>

        <association property="user" column="uuid" javaType="com.utonw.dealer.api.entity.erp.User">
            <result column="realname" property="realname" jdbcType="VARCHAR"/>
        </association>
        
</resultMap>

    <select id="getCustomerListPage" resultMap="getCustomerListPageResultMap" parameterType="map">
        SELECT
        cri.*, d.name dept_name, u.realname, com.name company_name
        FROM
        customer_register_info cri
        LEFT JOIN company com ON cri.company_id = com.id
        LEFT JOIN dept d ON cri.dept_id = d.id
        LEFT JOIN user u ON cri.responsible_cm_id = u.uuid
        WHERE
        1=1
        <!--<if test="companyId != null">-->
            <!--AND cri.company_id = #{companyId}-->
        <!--</if>-->
        <!--<if test="userId != null">-->
            <!--AND cri.responsible_cm_id = #{userId}-->
        <!--</if>-->
        <if test="mobile != null">
            AND cri.mobile LIKE CONCAT('%', #{mobile},'%')
        </if>
        <if test="name">
            AND cri.customer_name LIKE CONCAT('%', #{name},'%')
        </if>
        <if test="idCard != null">
            AND cri.id_card LIKE CONCAT('%', #{idCard},'%')
        </if>
        <if test="customer_source != null">
        	<if test="customer_source == 0">
        		AND (cri.open_id = '' or cri.open_id is null)
        	</if>
        	<if test="customer_source == 1">
        		AND cri.open_id is not null and cri.open_id  <![CDATA[<> ]]> ''
        	</if>
        </if>
        <if test="customer_latent != null">
        	<if test="customer_latent == 0">
				AND (select count(1) from loan_info li where li.customer_id = cri.uuid) = 0 AND cri.is_blacklist = 0
        	</if>
        	<if test="customer_latent == 1">
				AND (select count(1) from loan_info li where li.customer_id = cri.uuid) > 0 AND cri.is_blacklist = 0
        	</if>
        	<if test="customer_latent == 2">
        		AND cri.is_blacklist = 1
        	</if>
        </if>
        <choose>
            <when test="data_access_level != null and data_access_level == 0">
                and 1=0
            </when>
            <when test="data_access_level != null and data_access_level == 1">
                AND cri.responsible_cm_id = #{userId}
            </when>
            <when test="data_access_level != null and data_access_level == 2">
                AND cri.dept_id = #{dept_id}
            </when>
            <when test="data_access_level != null and data_access_level == 3">
                AND cri.company_id = #{companyId}
            </when>
        </choose>
        ORDER BY
        cri.created_at DESC
    </select>

    <select id="queryYestdAddCus" resultType="java.lang.Long">
        SELECT IFNULL(count(1), 0) FROM customer_register_info cri WHERE cri.register_status =
        "done" AND cri.created_at BETWEEN DATE_FORMAT(date_sub(CURDATE(), INTERVAL 1 DAY),
        '%Y-%m-%d %H-%i-%s') AND
      DATE_FORMAT(CURDATE(), '%Y-%m-%d %H-%i-%s')
    </select>
    
    <select id="selectByIdCard" resultMap="getCustomerAllInfo" parameterType="java.lang.String">
    	select cri.*,
    	cai.account_name,cai.branch_bank_name,cai.account_num
    	from 
    	customer_register_info cri 
    	left join customer_account_info cai on cai.customer_id = cri.uuid
    	where cri.id_card = #{idCard,jdbcType=VARCHAR}
    </select>
    
    <select id="selectNewCustomer" resultMap="getCustomerListPageResultMap" parameterType="map">
        SELECT
        cri.*, d.name dept_name, u.realname, com.name company_name
        FROM
        customer_register_info cri
        LEFT JOIN company com ON cri.company_id = com.id
        LEFT JOIN dept d ON cri.dept_id = d.id
        LEFT JOIN user u ON cri.responsible_cm_id = u.uuid
        WHERE
        1=1
        <if test="time != null">
            AND DATE_FORMAT(cri.created_at,'%Y-%m') =  DATE_FORMAT(#{time},'%Y-%m') 
        </if>
        <choose>
            <when test="data_access_level != null and data_access_level == 0">
                and 1=0
            </when>
            <when test="data_access_level != null and data_access_level == 1">
                AND li.responsible_cm_id = #{userId,
		jdbcType=VARCHAR}
            </when>
            <when test="data_access_level != null and data_access_level == 2">
                AND li.dept_id = #{myDeptId,jdbcType=INTEGER}
            </when>
            <when test="data_access_level != null and data_access_level == 3">
                AND li.company_id = #{mycompanyId,jdbcType=INTEGER}
            </when>
        </choose>
        ORDER BY
        cri.created_at DESC
    </select>
    
    <resultMap extends="ResultMapWithBLOBs" id="getCustomerAllInfo"
               type="com.utonw.dealer.api.entity.erp.CustomerRegisterInfoWithBLOBS">
        <association property="customerAccountInfo" column="customer_id"
                     javaType="com.utonw.dealer.api.entity.erp.CustomerRegisterInfo">
            <result column="account_name" property="accountName" jdbcType="VARCHAR"/>
            <result column="branch_bank_name" property="branchBankName" jdbcType="VARCHAR"/>
            <result column="account_num" property="accountNum" jdbcType="VARCHAR"/>
        </association>

    </resultMap>


</mapper>